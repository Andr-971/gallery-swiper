"use strict";export default class Gallery{constructor(i,e={}){this.containerNode=i,this.sizeSlide=i.childElementCount,this.options=e,this.slideIndex=0,this.trfRegExp=/([-0-9.]+(?=px))/,this.infiniteSlide=e.infiniteSlide,this.autoFlipping=!0,void 0!==e.autoscrolling&&(this.autoscrolling=!0,void 0!==e.autoscrolling.left?this.autoscrollingLeft=e.autoscrolling.left:void 0!==e.autoscrolling.right&&(this.autoscrollingRight=e.autoscrolling.right),void 0!==e.autoscrolling.delay)&&(this.autoscrollingDelay=+e.autoscrolling.delay),void 0!==e.controls&&(this.btnPrevControlHTML=document.getElementById(e.controls.prevId),this.btnNextControlHTML=document.getElementById(e.controls.nextId)),this.btnPrevlHTMLBulean=null!==this.btnPrevControlHTML,this.btnNextlHTMLBulean=null!==this.btnNextControlHTML,(this.btnPrevlHTMLBulean||this.btnNextlHTMLBulean)&&void 0!==e.controls&&((this.btnPrevlHTMLBulean||this.btnNextlHTMLBulean)&&(this.btnLeft=document.getElementById(""+e.controls.prevId)),this.btnRight=document.getElementById(""+e.controls.nextId)),void 0!==e.bullets&&(this.bulletHTML=document.getElementById(""+e.bullets.bulletsId),void 0!==e.bullets.bulletsId&&null!==this.bulletHTML&&(this.bullets=document.getElementById(""+e.bullets.bulletsId)),void 0!==e.bullets.namberBullet&&(this.namberBullet=e.bullets.namberBullet),this.bulletItems=!0),void 0!==e.numberSlide&&(this.numberSlide=e.numberSlide.numberSlideShow),void 0!==e.progressBar&&(this.progressBar=e.progressBar.progressBarShow,this.progressColor=e.progressBar.progressColor,this.trackColor=e.progressBar.trackColor),this.manageHTML=this.manageHTML.bind(this),this.setParameters=this.setParameters.bind(this),this.setEvents=this.setEvents.bind(this),this.resizeGallery=this.resizeGallery.bind(this),this.clickSlide=this.clickSlide.bind(this),this.draggingSlide=this.draggingSlide.bind(this),this.lettingSlide=this.lettingSlide.bind(this),this.switchingSlides=this.switchingSlides.bind(this),this.slideMovement=this.slideMovement.bind(this),this.next=this.next.bind(this),this.prev=this.prev.bind(this),this.btnPrev=this.btnPrev.bind(this),this.btnNext=this.btnNext.bind(this),this.autoFlippingSlide=this.autoFlippingSlide.bind(this),this.handlerBullets=this.handlerBullets.bind(this),this.activeBullet=this.activeBullet.bind(this),this.activeNumberSlide=this.activeNumberSlide.bind(this),this.changesProgressBar=this.changesProgressBar.bind(this),this.manageHTML(),this.setParameters(),this.setEvents(),this.changesProgressBar(this.slideIndex,this.sizeSlide),this.autoscrolling&&this.autoFlippingSlide()}manageHTML(){this.containerNode.classList.add(this.options.class.galleryClassName),this.containerNode.innerHTML=`
            <div class="${this.options.class.galleryLineClassName}">
                ${this.containerNode.innerHTML}
            </div>
        `,this.lineNode=this.containerNode.querySelector("."+this.options.class.galleryLineClassName),this.slideNodes=Array.from(this.lineNode.children).map(i=>wrapElementByDiv({element:i,className:this.options.class.gallerySlideClassName}));for(let i=0;i<this.sizeSlide;i++)void 0!==this.options.bullets&&void 0!==this.options.bullets.bulletsId&&void 0!==this.bullets&&(this.bullets.innerHTML+=`
                    <li class="bullet">
                    </li>
                    `);var i;this.numberSlide&&((i=document.createElement("div")).className=""+this.options.numberSlide.numberSlideClass,i.innerHTML=`
            <span class="one-text">Слайд: </span>
            <span class="${this.options.numberSlide.numberSlideCuurent}">${this.slideIndex+1}</span>
            <span class="separator"> из </span>
            <span class="length-slide">${this.sizeSlide}</span>
            `,this.containerNode.prepend(i)),this.progressBar&&((i=document.createElement("div")).className=""+this.options.progressBar.progressBarClass,i.innerHTML=`
                <div class="${this.options.progressBar.progressBarChildClass}"></div>
            `,this.containerNode.append(i))}setParameters(){this.widthSlide=this.lineNode.getBoundingClientRect().width;var i,e=this.containerNode.getBoundingClientRect();this.widthContiner=e.width,this.lineNode.style.cssText="position: relative",this.lineNode.style.transform=`translate3d(-${this.slideIndex*this.widthSlide}px, 0px, 0px)`,this.windowScreenWidth=window.screen.width,(this.btnPrevlHTMLBulean||this.btnNextlHTMLBulean)&&0===this.slideIndex&&void 0!==this.options.controls&&(this.btnLeft.hidden=!0),void 0!==this.options.indent&&(this.breckPoint=Object.keys(this.options.indent),this.breckPointValues=Object.values(this.options.indent),this.windowScreenWidth>this.breckPoint[3]&&(this.indentWidht=this.breckPointValues[3]),this.windowScreenWidth<=this.breckPoint[3]&&(this.indentWidht=this.breckPointValues[3]),this.windowScreenWidth<=this.breckPoint[2]&&(this.indentWidht=this.breckPointValues[2]),this.windowScreenWidth<=this.breckPoint[1]&&(this.indentWidht=this.breckPointValues[1]),this.windowScreenWidth<=this.breckPoint[0])&&(this.indentWidht=this.breckPointValues[0]),void 0!==this.indentWidht?this.lineNode.style.width=this.sizeSlide*(this.widthContiner+this.indentWidht)+"px":this.lineNode.style.width=this.sizeSlide*this.widthContiner+"px",this.numberLastIndexSlide=--this.sizeSlide,Array.from(this.slideNodes).forEach((i,e)=>{i.style.width=this.widthContiner+"px",i.dataset.id=e+1,0===e&&i.setAttribute("data-active","active"),"undefined"!==this.indentWidht&&(i.style.marginRight=this.indentWidht+"px")}),this.options.widthWindowsSlider&&(i=100*this.options.widthWindowsSlider,this.realWidth=e.width/100*i,this.containerNode.style.width=this.realWidth+"px"),this.indentWidht&&(this.lineNode.lastChild.previousElementSibling.style.marginRight="0px"),this.namberBullet&&void 0!==this.bullets&&Array.from(this.bullets.children).forEach(function(i,e){i.innerText=e+1}),void 0!==this.bullets&&Array.from(this.bullets.children).forEach(function(i,e,t){i.dataset.id=e+1}),void 0!==this.bullets&&(this.bullets.children[this.slideIndex].dataset.active="active"),this.numberSlide&&(this.numberCurrSlide=document.querySelector("."+this.options.numberSlide.numberSlideCuurent)),this.progressBar&&(this.getProgressBar=document.querySelector("."+this.options.progressBar.progressBarChildClass))}setEvents(){window.addEventListener("resize",this.resizeGallery),this.lineNode.addEventListener("mousedown",this.clickSlide),this.lineNode.addEventListener("mouseup",this.lettingSlide),(this.btnPrevlHTMLBulean||this.btnNextlHTMLBulean)&&void 0!==this.options.controls&&(this.btnLeft.addEventListener("click",this.btnPrev),this.btnRight.addEventListener("click",this.btnNext)),void 0!==this.bullets&&this.bullets.addEventListener("click",this.handlerBullets),(/Android|webOS|iPhone|iPad|iPod|BlackBerry/i.test(navigator.userAgent)||/Android|webOS|iPhone|iPad|iPod|BlackBerry/i.test(navigator.platform))&&(this.touchScreen=!0,this.lineNode.addEventListener("touchstart",this.clickSlide),this.lineNode.addEventListener("touchend",this.lettingSlide)),this.containerNode.ondragstart=function(){return!1}}destroyEvents(){window.removeEventListener("resize",this.resizeGallery)}resizeGallery(){this.setParameters(),location.reload()}clickSlide(i){this.autoscrolling=!1,this.posThreshold=this.widthSlide/100*this.options.percentShift,this.lineNode.style.transition="",this.touchScreen?this.posX1=i.touches[0].pageX:this.posX1=i.pageX,this.posInit=this.posX1,this.lineNode.addEventListener("mousemove",this.draggingSlide),this.lineNode.addEventListener("touchmove",this.draggingSlide)}lettingSlide(i){if(this.posFinal=this.posInit-this.posX1,Math.abs(this.posFinal)>this.posThreshold){let i;this.posInit<this.posX1?(i=Array.from(this.lineNode.children)[this.slideIndex].removeAttribute("data-active"),this.infiniteSlide?this.infiniteSlide&&(this.slideIndex<=0&&(this.slideIndex=this.numberLastIndexSlide+1,this.slideMovement("noDelay",this.slideIndex)),this.slideIndex--,this.activeBullet(this.slideIndex),this.activeNumberSlide(this.slideIndex),this.changesProgressBar(this.slideIndex,this.sizeSlide)):0<this.slideIndex&&(this.slideIndex--,0===this.slideIndex&&(this.btnLeft.hidden=!0),this.slideIndex===this.numberLastIndexSlide-1&&(this.btnRight.hidden=!1),this.activeBullet(this.slideIndex),this.activeNumberSlide(this.slideIndex),this.changesProgressBar(this.slideIndex,this.sizeSlide)),i=Array.from(this.lineNode.children)[this.slideIndex].dataset.active="active"):this.posInit>this.posX1&&(i=Array.from(this.lineNode.children)[this.slideIndex].removeAttribute("data-active"),this.infiniteSlide?this.infiniteSlide&&(this.slideIndex>=this.numberLastIndexSlide&&(this.slideIndex=0,this.slideMovement("noDelay",this.slideIndex),this.slideIndex=-1),this.noContainerBtn&&(this.btnLeft.hidden=!1),this.slideIndex++,this.activeBullet(this.slideIndex),this.activeNumberSlide(this.slideIndex),this.changesProgressBar(this.slideIndex,this.sizeSlide)):(this.slideIndex<this.numberLastIndexSlide&&(this.slideIndex===this.numberLastIndexSlide-1&&(this.btnRight.hidden=!0),this.slideIndex++,this.btnLeft.hidden=!1),this.activeBullet(this.slideIndex),this.activeNumberSlide(this.slideIndex),this.changesProgressBar(this.slideIndex,this.sizeSlide)),i=Array.from(this.lineNode.children)[this.slideIndex].dataset.active="active"),this.posInit!==this.posX1&&this.slideMovement("delay",this.slideIndex)}this.lineNode.removeEventListener("mousemove",this.draggingSlide),this.lineNode.removeEventListener("touchmove",this.draggingSlide)}draggingSlide(i){this.touchScreen?(this.posX2=this.posX1-i.touches[0].pageX,this.posX1=i.touches[0].pageX):(this.posX2=this.posX1-i.pageX,this.posX1=i.pageX),this.style=this.lineNode.style.transform,this.transform=Math.round(+this.style.match(this.trfRegExp)[0]),this.lineNode.style.transform=`translate3d(${this.transform-this.posX2}px, 0px, 0px)`}slideMovement(i,e){return"delay"===i&&(this.lineNode.style.transition=`transform ${this.options.secondDelay} ease 0s`),"noDelay"===i&&(this.lineNode.style.transition="transform 0s ease 0s"),this.lineNode.style.transform=`translate3d(-${e*(this.widthSlide+this.indentWidht)}px, 0px, 0px)`}switchingSlides(i){this.slideIndex=i,this.slideMovement("delay",this.slideIndex)}next(){var i;this.infiniteSlide?this.infiniteSlide&&((i=Array.from(this.lineNode.children)[this.slideIndex]).removeAttribute("data-active"),this.slideIndex>=this.numberLastIndexSlide&&(this.slideIndex=0,this.slideMovement("noDelay",this.slideIndex),this.slideIndex=-1),this.switchingSlides(++this.slideIndex),0!==this.slideIndex&&(this.btnLeft.hidden=!1),i.dataset.active="active",this.activeBullet(this.slideIndex),this.activeNumberSlide(this.slideIndex),this.changesProgressBar(this.slideIndex,this.sizeSlide)):this.slideIndex<this.numberLastIndexSlide&&((i=Array.from(this.lineNode.children)[this.slideIndex]).removeAttribute("data-active"),this.switchingSlides(++this.slideIndex),i.dataset.active="active",this.slideIndex===this.numberLastIndexSlide&&(this.btnRight.hidden=!0),0!==this.slideIndex&&(this.btnLeft.hidden=!1),this.activeBullet(this.slideIndex),this.activeNumberSlide(this.slideIndex),this.changesProgressBar(this.slideIndex,this.sizeSlide))}prev(){var i;this.autoscrolling=!1,this.infiniteSlide?this.infiniteSlide&&((i=Array.from(this.lineNode.children)[this.slideIndex]).removeAttribute("data-active"),this.slideIndex<=0&&(this.slideIndex=this.numberLastIndexSlide+1,this.slideMovement("noDelay",this.slideIndex)),this.switchingSlides(--this.slideIndex),i.dataset.active="active",this.activeBullet(this.slideIndex),this.activeNumberSlide(this.slideIndex),this.changesProgressBar(this.slideIndex,this.sizeSlide)):(0<this.slideIndex&&((i=Array.from(this.lineNode.children)[this.slideIndex]).removeAttribute("data-active"),this.switchingSlides(--this.slideIndex),i.dataset.active="active"),this.slideIndex!==this.numberLastIndexSlide&&(this.btnRight.hidden=!1),0===this.slideIndex&&(this.btnLeft.hidden=!0),this.activeBullet(this.slideIndex),this.activeNumberSlide(this.slideIndex),this.changesProgressBar(this.slideIndex,this.sizeSlide))}btnPrev(){this.prev()}btnNext(){this.next()}autoFlippingSlide(){var i;this.autoFlipping&&(i=1e3*this.autoscrollingDelay,this.autoscrollingLeft?setInterval(()=>this.prev(),i):this.autoscrollingRight&&setInterval(()=>this.next(),i))}handlerBullets(i){Array.from(this.bullets.children).forEach(function(i,e,t){i.removeAttribute("data-active")}),i.target.dataset.active="active",this.slideIndex=i.target.getAttribute("data-id")-1,this.slideMovement("delay",this.slideIndex),this.activeNumberSlide(this.slideIndex),this.changesProgressBar(this.slideIndex,this.sizeSlide)}activeBullet(i){this.bulletItems&&this.bullets&&(Array.from(this.bullets.children).forEach(function(i,e,t){i.removeAttribute("data-active")}),this.bullets.children[i].dataset.active="active")}activeNumberSlide(i){void 0!==this.numberCurrSlide&&(this.numberCurrSlide.innerText=i+1)}changesProgressBar(i,e){void 0!==this.getProgressBar&&(this.getProgressBar.style.background=`linear-gradient(90deg, ${this.progressColor} 0%, ${this.progressColor} ${i=(i+1)/(e+1)*100}%,
            ${this.trackColor} ${i}%, ${this.trackColor} 100%)`)}}function wrapElementByDiv({element:i,className:e}){var t=document.createElement("div");return t.classList.add(e),i.parentNode.insertBefore(t,i),t.appendChild(i),t}